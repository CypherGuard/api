# CypherGuard API

## Introduction

CypherGuard API is a RESTful API that provides a set of services to manage and interact with CypherGuard's products.

## Authentication

The API uses JWT (JSON Web Token) for authentication. The token is passed in the header of the request. The token is generated by the authentication service and is valid for 24 hours.

## Environment Variables

## Docker

### Services

| Services name | Image                  | Ports                 | Network     | Volumes                          |
|---------------|------------------------|-----------------------|-------------|----------------------------------|
| Application   | leafphp/docker         | 8080:80               | mq pgsql_db | .:/var/www                       |
| PgpServer     | Dockerfile             |                       | mq          | ./pgp_server:/pgp_server         |
| Pgsql         | postgres:9.6           | 5432:5432             | pgsql_db    | ./pgsql:/var/lib/postgresql/data |
| MailCatcher   | schickling/mailcatcher | 1080:1080 1025:1025   |             |                                  |
| LavinMQ       | cloudamqp/lavinmq      | 5672:5672 15672:15672 | mq          |                                  |

### Commands

```bash
docker-compose up -d
```

## Installation

### Requirements

- PHP 7.4
- Composer

### Steps

1. Clone the repository
2. Run `composer install`
3. Create a `.env` file and set the environment variables
4. Run `docker-compose up -d`
5. Run `php leaf db:migrate`

| Cl√©                | Valeur                                              |
|--------------------|-----------------------------------------------------|
| `APP_NAME`         | LEAF_MVC                                            |
| `APP_ENV`          | local                                               |
| `APP_KEY`          | base64:E0dZjrwXdMI/LngqgIOYZ1OCXlmtdAGyvrtV2nXaSSk= |
| `APP_DOWN`         | false                                               |
| `APP_DEBUG`        | true                                                |
| `APP_PORT`         | 5500                                                |
| `APP_URL`          | http://localhost:5500/                              |
| `DB_CONNECTION`    | pgsql                                               |
| `DB_HOST`          | pgsql                                               |
| `DB_PORT`          | 5432                                                |
| `DB_DATABASE`      | leafphp                                             |
| `DB_USERNAME`      | leafphp                                             |
| `DB_PASSWORD`      | leafphp                                             |
| `# DB_COLLATION`   | utf8_general_ci                                     |
| `MAIL_DRIVER`      | smtp                                                |
| `MAIL_HOST`        | smtp.mailtrap.io                                    |
| `MAIL_PORT`        | 2525                                                |
| `MAIL_DEBUG`       | SERVER                                              |
| `MAIL_USERNAME`    | null                                                |
| `MAIL_PASSWORD`    | null                                                |
| `MAIL_ENCRYPTION`  | null                                                |
| `PROD_SERVER`      | hello                                               |
| `PROD_PORT`        | 22                                                  |
| `PROD_USER`        | leaf                                                |
| `SERVER_NAME`      | LEAF_SERVER                                         |
| `SERVER_PORT`      | 5500                                                |
| `SERVER_USER`      |                                                     |
| `SERVER_PASSWORD`  |                                                     |
| `APPLICATION_DIR`  | leaf                                                |
| `APPLICATION_PATH` | leaf                                                |
| `CLOUDAMQP_URL`    | amqp://guest:guest@lavinmq:5672/                    |
| `ENCRYPTION_KEY`   | 5b0f00a08                                           |

## How password storage work

- The user get the public key of the server
- The user encrypt the password with the public key
- The user send the encrypted password to the server
- The server decrypt the password with the private key
- The server encrypt with AES-256 the password
- The server store the encrypted password in the database

## How password retrieval work

- The user request the password and send his public key
- The server decrypt the password with AES-256
- The server encrypt the password with the public key of the user
- The server send the encrypted password to the user
- The user decrypt the password with his private key
- The user get the password

## Endpoints

The API has the following endpoints:

- /auth
- /users
- /pgp
- /vaults
- /vaults/{vaultId}/logins

## /auth

The /auth category is the authentication service. It provides the following endpoints:

- /auth/login
- /auth/register
- /auth/me

## /users

The /users category is the user service. It provides the following endpoints:

None

## /pgp

The /pgp category is the PGP service. It provides the following endpoints:

- /pgp/key

## /vaults

The /vaults category is the vault service. It provides the following endpoints:

- /vaults
- /vaults/{vaultId}

## /vaults/{vaultId}/logins

The /vaults/{vaultId}/logins category is the login service. It provides the following endpoints:

- /vaults/{vaultId}/logins
- /vaults/{vaultId}/logins/{loginId}

# Acknowledgements

Libraries used in this project:

- [LeafPHP](https://leafphp.dev/)
- [php-amqplib](https://github.com/php-amqplib/php-amqplib)

# License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

# Contact

For any questions or feedback, please contact us at [

